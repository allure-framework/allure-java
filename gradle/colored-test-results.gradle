import org.gradle.internal.logging.text.StyledTextOutputFactory
import static org.gradle.internal.logging.text.StyledTextOutput.Style

test {
    def out = services.get(StyledTextOutputFactory).create("test-results-colored")
    afterTest { descriptor, result ->
        def style
        if (result.failedTestCount > 0) style = Style.Failure
        else if (result.skippedTestCount > 0) style = Style.ProgressStatus
        else style = Style.Success
        out.withStyle(style).format('%s ', result)
        out.println(descriptor)
    }
}